<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
  <Product Id="*" Name="Analog Clock" 
           Language="1033" Version="0.5.5"
           Manufacturer="High Bridge" 
           UpgradeCode="fe287b25-e03d-4744-90f4-96b05dc36bf0">
    <Package Description="Analog Clock Gadget"
             Comments="(c) 2019 High Bridge"
             InstallerVersion="200" Compressed="yes"
             InstallScope="perMachine" />
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed. Setup will now exit." />
    <MediaTemplate EmbedCab="yes" />

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFiles64Folder">
	<Directory Id="CompanyFolder" Name="High Bridge">
	  <Directory Id="ApplicationFolder" Name="AnalogClock" />
	</Directory>
      </Directory>
      <Directory Id="ProgramMenuFolder">
          <Directory Id="ApplicationProgramsFolder" Name="High Bridge" />
      </Directory>
    </Directory>

    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ApplicationShortcut" Guid="*">
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Icon="java.exe"
                  Name="Analog Clock Gadget"
                  Show="minimized"
                  Target="[ApplicationFolder]\bin\analogclock.bat"
                  WorkingDirectory="ApplicationFolder"/>
        <RemoveFolder Id="CleanUpShortcut"
                      Directory="ApplicationProgramsFolder"
                      On="uninstall" />
        <RegistryValue Root="HKCU"
                       Key="Software\[Manufacturer]\[ProductName]"
                       Name="installed" Type="integer" Value="1"
                       KeyPath="yes"/>
      </Component>
    </DirectoryRef>

    <Icon Id="java.exe" SourceFile="runtime\bin\java.exe" />
    
    <Feature Id="Product" Title="Analog Clock" Level="1">
      <ComponentGroupRef Id="RuntimeGroup" />
      <ComponentRef Id="ApplicationShortcut" />
    </Feature>

    <UIRef Id="WixUI_Minimal" />
    <WixVariable Id="WixUILicenseRtf" Value="License.rtf" />

  </Product>
</Wix>
